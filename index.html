
<!DOCTYPE html>
<html>
<head>
    <style>
      #game-board {
          display: grid;
          grid-template-columns: repeat(7, 1fr);
          grid-template-rows: repeat(7, 1fr);
          gap: 0px;
          width: 90vw;
          height: 90vw;
          max-width: 700px;
          max-height: 700px;
      }

      .tile {
          border: 1px solid #000;
          display: flex;
          justify-content: center;
          align-items: center;
          font-size: 3vw;
          font-weight:bold;
          -webkit-touch-callout: none;
          -webkit-user-select: none;
          -khtml-user-select: none;
          -moz-user-select: none;
          -ms-user-select: none;
          user-select: none;
      }

      @media (min-width: 700px) {
        .tile {
          font-size: 48px;
        }
      }

      .empty {
          background-color: white;
      }

      .filled {
          background-color: lightgrey;
      }

      .valid {
        background-color: green;
      }

    </style>
</head>
<body>
  <div id="game-board">
    <div class='tile' id='tile0'></div>
    <div class='tile' id='tile1'></div>
    <div class='tile' id='tile2'></div>
    <div class='tile' id='tile3'></div>
    <div class='tile' id='tile4'></div>
    <div class='tile' id='tile5'></div>
    <div class='tile' id='tile6'></div>
    <div class='tile' id='tile7'></div>
    <div class='tile' id='tile8'></div>
    <div class='tile' id='tile9'></div>
    <div class='tile' id='tile10'></div>
    <div class='tile' id='tile11'></div>
    <div class='tile' id='tile12'></div>
    <div class='tile' id='tile13'></div>
    <div class='tile' id='tile14'></div>
    <div class='tile' id='tile15'></div>
    <div class='tile' id='tile16'></div>
    <div class='tile' id='tile17'></div>
    <div class='tile' id='tile18'></div>
    <div class='tile' id='tile19'></div>
    <div class='tile' id='tile20'></div>
    <div class='tile' id='tile21'></div>
    <div class='tile' id='tile22'></div>
    <div class='tile' id='tile23'></div>
    <div class='tile' id='tile24'></div>
    <div class='tile' id='tile25'></div>
    <div class='tile' id='tile26'></div>
    <div class='tile' id='tile27'></div>
    <div class='tile' id='tile28'></div>
    <div class='tile' id='tile29'></div>
    <div class='tile' id='tile30'></div>
    <div class='tile' id='tile31'></div>
    <div class='tile' id='tile32'></div>
    <div class='tile' id='tile33'></div>
    <div class='tile' id='tile34'></div>
    <div class='tile' id='tile35'></div>
    <div class='tile' id='tile36'></div>
    <div class='tile' id='tile37'></div>
    <div class='tile' id='tile38'></div>
    <div class='tile' id='tile39'></div>
    <div class='tile' id='tile40'></div>
    <div class='tile' id='tile41'></div>
    <div class='tile' id='tile42'></div>
    <div class='tile' id='tile43'></div>
    <div class='tile' id='tile44'></div>
    <div class='tile' id='tile45'></div>
    <div class='tile' id='tile46'></div>
    <div class='tile' id='tile47'></div>
    <div class='tile' id='tile48'></div>

  </div>

<script>

let dictionary;
fetch('words.json')
  .then(response => response.json())
  .then(jsonData => {
    dictionary = new Set(Object.keys(jsonData));
  })
  .catch(error => console.error(error));

function getRandomLetter() {
  const alphabet = "ORBITCHEMOCOLONUNIFYREEFS";
  return alphabet[Math.floor(Math.random() * alphabet.length)];
}

function findWords() {
    const gridSize = 7;  // Grid is 7x7
    const tiles = Array.from(document.querySelectorAll('.tile'));

    let words = [];  // List to hold the found words

    // Function to add word to the list
    function addWord(word, ids) {
        if (word.length > 2) {  // We only care about words of length 2 or more
            let valid = isDictionaryWord(word);
            words.push({word, ids, valid});
        }
    }

    // Find horizontal words
    for (let row = 0; row < gridSize; row++) {
        let word = '';
        let ids = [];
        for (let col = 0; col < gridSize; col++) {
            let index = row * gridSize + col;
            let tile = tiles[index];
            if (tile.textContent !== '') {
                word += tile.textContent;
                ids.push(tile.id);
            } else if (word !== '') {
                addWord(word, ids);
                word = '';
                ids = [];
            }
        }
        addWord(word, ids);  // Check for word at the end of the row
    }

    // Find vertical words
    for (let col = 0; col < gridSize; col++) {
        let word = '';
        let ids = [];
        for (let row = 0; row < gridSize; row++) {
            let index = row * gridSize + col;
            let tile = tiles[index];
            if (tile.textContent !== '') {
                word += tile.textContent;
                ids.push(tile.id);
            } else if (word !== '') {
                addWord(word, ids);
                word = '';
                ids = [];
            }
        }
        addWord(word, ids);  // Check for word at the end of the column
    }

    return words;
}

function isDictionaryWord(word) {
    return dictionary.has(word.toLowerCase());
}

function highlightValidWords() {
    const tiles = Array.from(document.querySelectorAll('.tile')); // Add this line
    // Remove 'valid' class from all tiles and add 'filled' class
    tiles.forEach(tile => {
        tile.classList.remove('valid');
        if (tile.textContent.trim() !== "") {
            tile.classList.add('filled');
        }
    });

    const words = findWords();
    words.forEach(({ids, valid}) => {
        if (valid) {
            ids.forEach(id => {
                let tile = document.getElementById(id);
                // Add 'valid' class and remove 'filled' class if part of a valid word
                tile.classList.add('valid');
                tile.classList.remove('filled');
            });
        }
    });
}



document.addEventListener('DOMContentLoaded', (event) => {
    const tiles = Array.from(document.querySelectorAll('.tile'));

    let filledIndices = [8, 9, 10, 11, 12, 15, 16, 17, 18, 19, 22, 23, 24, 25, 26, 29, 30, 31, 32, 33, 36, 37, 38, 39, 40];

    // Shuffle the letters for the tiles
    let letters = Array.from("ORBITCHEMOCOLONUNIFYREEFS");
    for(let i = letters.length - 1; i > 0; i--){
        const j = Math.floor(Math.random() * i);
        const temp = letters[i];
        letters[i] = letters[j];
        letters[j] = temp;
    }

    // Assign letters to tiles and color them grey
    for(let i = 0; i < 25; i++){
        tiles[filledIndices[i]].textContent = letters[i];
        tiles[filledIndices[i]].classList.add('filled');
    }

    // Assign empty strings to the rest of the tiles and color them white
    for(let i = 0; i < tiles.length; i++){
        if (!filledIndices.includes(i)) {
            tiles[i].textContent = '';
            tiles[i].classList.add('empty');
        }
    }

    tiles.forEach(tile => {
        tile.setAttribute('draggable', 'true');

        const handleDragStart = (event) => {
            draggedTileId = event.target.id;
        };

        const handleDrop = (event) => {
            const sourceId = draggedTileId;
            const sourceElement = document.getElementById(sourceId);
            const targetElement = event.target;

            // Swap classes
            let sourceClass = sourceElement.className;
            let targetClass = targetElement.className;
            sourceElement.className = targetClass;
            targetElement.className = sourceClass;

            // Swap text (letter)
            const temp = sourceElement.textContent;
            sourceElement.textContent = targetElement.textContent;
            targetElement.textContent = temp;

            draggedTileId = null; // reset the activeTileId

            highlightValidWords()
        };

        const handleDragOver = (event) => {
            event.preventDefault();
        };

        // Handle mouse events
        tile.addEventListener('dragstart', (event) => {
            event.dataTransfer.setData('text/plain', event.target.id);
            draggedTileId = event.target.id;
        });
        tile.addEventListener('dragover', handleDragOver);
        tile.addEventListener('drop', handleDrop);

        // Handle touch events
        let touchSourceId = null;

        tile.addEventListener('touchstart', (event) => {
            touchSourceId = event.target.id;
        });

        tile.addEventListener('touchmove', (event) => {
            event.preventDefault(); // prevent scrolling while moving
        });

        tile.addEventListener('touchend', (event) => {
            const touchTarget = document.elementFromPoint(event.changedTouches[0].clientX, event.changedTouches[0].clientY);
            if (touchSourceId && touchTarget && touchTarget.classList.contains('tile')) {
                draggedTileId = touchSourceId;
                handleDrop({target: touchTarget});
            }
            touchSourceId = null;
        });
    });


      });

</script>
</body>
</html>
